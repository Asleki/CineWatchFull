<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>CineWatch - TV Networks</title>

  <!-- Font Awesome CDN for icons -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
  <!-- Inter Font (for consistent typography across the site) -->
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">

  <!-- Consolidated Main Stylesheet - Copied from existing pages for consistency -->
  <style>
    /* Root Theme Variables */
    :root {
      --bg: #fff;
      --text: #111;
      --header-bg: #f0ecec;
      --search-bg: #f4f4f4;
      --card-border: #eee;
      --card-shadow: rgba(0, 0, 0, 0.05);
      --highlight: #007bff;
      --accent: #28a745;
      --danger: #dc3545;
      --info: #17a2b8;
      --warning: #ffc107;
      --modal-bg: rgba(0, 0, 0, 0.5);
      --modal-content-bg: #fff;
      --modal-text: #111;
      --search-area-height: 120px;

      /* New Variables for Homepage Content */
      --hero-overlay: rgba(0, 0, 0, 0.6);
      --section-padding: 40px 20px;
      --carousel-gap: 20px;
      --card-bg: #fff;
      --card-text: #111;
      --card-rating-bg: var(--accent);
      --card-rating-text: #fff;
      --button-hover: #0056b3;

      /* Search Suggestions */
      --suggestions-bg: #fff;
      --suggestions-border: #ddd;
      --suggestions-item-hover-bg: #f0f0f0;

      /* Carousel Specific */
      --carousel-arrow-bg: rgba(0, 0, 0, 0.5);
      --carousel-arrow-color: #fff;
      --carousel-arrow-hover-bg: rgba(0, 0, 0, 0.7);
    }

    /* Dark Mode Variables */
    body.dark-mode {
      --bg: #1a1a1a;
      --text: #f0f0f0;
      --header-bg: #2a2a2a;
      --search-bg: #333;
      --card-border: #444;
      --card-shadow: rgba(0, 0, 0, 0.3);
      --highlight: #66b3ff;
      --accent: #4CAF50;
      --danger: #ff6b6b;
      --info: #00bcd4;
      --warning: #ffeb3b;
      --modal-bg: rgba(0, 0, 0, 0.7);
      --modal-content-bg: #282828;
      --modal-text: #f0f0f0;

      /* Dark Mode for New Homepage Content */
      --hero-overlay: rgba(0, 0, 0, 0.75);
      --card-bg: #282828;
      --card-text: #f0f0f0;
      --card-rating-bg: var(--accent);
      --card-rating-text: #fff;
      --button-hover: #4a90d9;

      /* Search Suggestions Dark Mode */
      --suggestions-bg: #282828;
      --suggestions-border: #444;
      --suggestions-item-hover-bg: #3a3a3a;

      /* Carousel Specific Dark Mode */
      --carousel-arrow-bg: rgba(255, 255, 255, 0.2);
      --carousel-arrow-color: #f0f0f0;
      --carousel-arrow-hover-bg: rgba(255, 255, 255, 0.3);
    }

    /* Global Styles */
    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }

    html {
      scroll-behavior: smooth;
    }

    body {
      font-family: 'Inter', sans-serif;
      background-color: var(--bg);
      color: var(--text);
      transition: background-color 0.3s, color 0.3s;
      line-height: 1.6;
      min-height: 100vh;
      display: flex;
      flex-direction: column;
    }

    a {
      color: var(--highlight);
      text-decoration: none;
      transition: color 0.2s ease;
    }

    a:hover {
      color: var(--accent);
    }

    /* Accessibility: Focus styles */
    :focus-visible {
      outline: 2px solid var(--highlight);
      outline-offset: 2px;
    }

    /* Global Header Wrapper */
    .main-global-header {
      background-color: var(--header-bg);
      box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
      position: sticky;
      top: 0;
      z-index: 1000;
      transition: background-color 0.3s, box-shadow 0.3s;
    }

    /* Utility Header (Top Row) */
    .utility-header {
      padding: 10px 20px;
      display: flex;
      justify-content: space-between;
      align-items: center;
      border-bottom: 1px solid var(--card-border);
    }

    .logo a {
      font-size: 1.8rem;
      font-weight: 700;
      color: var(--highlight);
      text-transform: capitalize;
      letter-spacing: 1px;
      text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.1);
    }

    .header-utility-actions {
      display: flex;
      gap: 15px;
      align-items: center;
    }

    .search-bar-toggle button {
        background: none;
        border: none;
        color: var(--text);
        font-size: 1.5rem;
        cursor: pointer;
        padding: 5px;
        border-radius: 50%;
        transition: background-color 0.2s ease;
    }

    .search-bar-toggle button:hover {
        background-color: rgba(0, 0, 0, 0.05);
    }

    .account-menu {
      position: relative;
    }

    .account-button {
      background: none;
      border: none;
      color: var(--text);
      font-size: 1.5rem;
      cursor: pointer;
      padding: 5px;
      border-radius: 50%;
      transition: background-color 0.2s ease;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .account-button:hover {
      background-color: rgba(0, 0, 0, 0.05);
    }

    .theme-toggle-button {
      background: none;
      border: none;
      color: var(--text);
      font-size: 1.5rem;
      cursor: pointer;
      padding: 5px;
      border-radius: 50%;
      transition: background-color 0.2s ease;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .theme-toggle-button:hover {
      background-color: rgba(0, 0, 0, 0.05);
    }

    .account-dropdown {
      position: absolute;
      top: 100%;
      right: 0;
      background-color: var(--header-bg);
      border: 1px solid var(--card-border);
      border-radius: 8px;
      box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1);
      min-width: 180px;
      padding: 10px 0;
      z-index: 1001;
      opacity: 0;
      visibility: hidden;
      transform: translateY(10px);
      transition: opacity 0.3s ease, visibility 0.3s ease, transform 0.3s ease;
    }

    .account-dropdown.show {
      opacity: 1;
      visibility: visible;
      transform: translateY(0);
    }

    .account-dropdown a {
      display: flex;
      align-items: center;
      gap: 10px;
      padding: 10px 15px;
      color: var(--text);
      font-size: 0.95rem;
      white-space: nowrap;
      transition: background-color 0.2s ease, color 0.2s ease;
    }

    .account-dropdown a:hover {
      background-color: rgba(0, 0, 0, 0.05);
      color: var(--highlight);
    }

    .account-dropdown a i {
      width: 20px;
      text-align: center;
    }

    /* Mobile Menu Toggle - default state is hidden */
    .mobile-menu-toggle {
      background: none;
      border: none;
      color: var(--text);
      font-size: 1.5rem;
      cursor: pointer;
      display: none;
    }

    /* Main Navigation Header (Desktop Only) */
    .main-nav-header {
      padding: 10px 20px;
      display: flex;
      justify-content: center;
      gap: 30px;
      align-items: center;
    }

    /* Mobile Navigation Menu (Hidden by default, shown by JS toggle) */
    .mobile-nav-links {
      flex-direction: column;
      background-color: var(--header-bg);
      box-shadow: 0 2px 5px rgba(0,0,0,0.1);
      padding: 10px 20px;
      border-bottom: 1px solid var(--card-border);
      display: none;
    }

    /* Dynamic Search Area */
    .dynamic-search-area {
      background-color: var(--header-bg);
      padding: 15px 20px;
      overflow: hidden;
      max-height: 0;
      opacity: 0;
      transition: max-height 0.4s ease-out, opacity 0.4s ease-out;
      box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
      position: relative;
    }

    .dynamic-search-area.show {
      max-height: var(--search-area-height);
      opacity: 1;
    }

    .search-input-wrapper {
      display: flex;
      align-items: center;
      gap: 10px;
      margin-bottom: 15px;
      position: relative;
      z-index: 1050;
    }

    .dynamic-search-area input[type="text"] {
      flex-grow: 1;
      padding: 10px 15px;
      border: 1px solid var(--card-border);
      border-radius: 25px;
      background-color: var(--search-bg);
      color: var(--text);
      font-size: 1rem;
      transition: border-color 0.3s, box-shadow 0.3s;
    }

    .dynamic-search-area input[type="text"]:focus {
      border-color: var(--highlight);
      box-shadow: 0 0 0 2px rgba(0, 123, 255, 0.25);
      outline: none;
    }

    .search-icon-btn {
      background: none;
      border: none;
      color: var(--text);
      font-size: 1.2rem;
      cursor: pointer;
      padding: 5px;
      transition: color 0.2s ease;
    }
    .search-icon-btn:hover {
        color: var(--highlight);
    }

    .search-button-label {
      background-color: var(--highlight);
      color: #fff;
      padding: 8px 15px;
      border: none;
      border-radius: 20px;
      font-size: 0.9rem;
      font-weight: 600;
      cursor: pointer;
      transition: background-color 0.2s ease;
    }

    .search-button-label:hover {
      background-color: #0056b3;
    }

    .search-filters {
      display: flex;
      flex-wrap: wrap;
      gap: 15px;
      justify-content: center;
    }

    .search-filters select,
    .search-filters input[type="text"] {
      padding: 8px 12px;
      border: 1px solid var(--card-border);
      border-radius: 10px;
      background-color: var(--search-bg);
      color: var(--text);
      font-size: 0.9rem;
      min-width: 120px;
      flex: 1;
      max-width: 200px;
    }

    /* Search Suggestions Dropdown */
    .search-suggestions-container {
        position: absolute;
        top: calc(100% + 5px);
        left: 0;
        right: 0;
        background-color: var(--suggestions-bg);
        border: 1px solid var(--suggestions-border);
        border-radius: 8px;
        box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1);
        max-height: 250px;
        overflow-y: auto;
        z-index: 1000;
        display: none;
    }

    .search-suggestions-container.show {
        display: block;
    }

    .search-suggestion-item {
        display: flex;
        align-items: center;
        padding: 10px 15px;
        cursor: pointer;
        transition: background-color 0.2s ease;
        border-bottom: 1px solid var(--suggestions-border);
    }

    .search-suggestion-item:last-child {
        border-bottom: none;
    }

    .search-suggestion-item:hover {
        background-color: var(--suggestions-item-hover-bg);
    }

    .search-suggestion-item img {
        width: 40px;
        height: 60px;
        object-fit: cover;
        border-radius: 5px;
        margin-right: 10px;
        flex-shrink: 0;
    }

    .search-suggestion-info {
        flex-grow: 1;
        color: var(--text);
    }

    .search-suggestion-info h4 {
        font-size: 1rem;
        margin-bottom: 2px;
        white-space: nowrap;
        overflow: hidden;
        text-overflow: ellipsis;
    }

    .search-suggestion-info p {
        font-size: 0.85rem;
        color: var(--text);
        opacity: 0.7;
    }


    /* Main Content Area */
    main {
        flex-grow: 1;
        display: flex;
        flex-direction: column;
        padding: 0;
        color: var(--text);
    }

    /* Styles specific to TV Networks page */
    .tv-networks-section {
        padding: var(--section-padding);
        max-width: 1200px;
        margin: 0 auto;
        text-align: center;
    }

    .tv-networks-section h1 {
        font-size: 2.2rem;
        margin-bottom: 25px;
        color: var(--highlight);
    }

    .network-list-container {
        display: flex;
        flex-wrap: wrap;
        justify-content: center;
        gap: 20px;
        margin-bottom: 40px;
    }

    .network-card {
        background-color: var(--card-bg);
        border-radius: 12px;
        box-shadow: 0 4px 10px var(--card-shadow);
        transition: transform 0.2s ease, box-shadow 0.2s ease, background-color 0.2s ease;
        display: flex;
        flex-direction: column;
        align-items: center;
        padding: 20px;
        width: 150px; /* Fixed width for network cards */
        cursor: pointer;
        text-align: center;
    }

    .network-card:hover {
        transform: translateY(-5px);
        box-shadow: 0 6px 15px rgba(0, 0, 0, 0.15);
        background-color: var(--highlight);
        color: white;
    }

    .network-logo {
        max-width: 80px; /* Adjusted size for logos */
        height: auto;
        margin-bottom: 10px;
        filter: grayscale(100%); /* Desaturate logos when not hovered/selected */
        transition: filter 0.2s ease;
    }

    .network-card:hover .network-logo,
    .network-card.selected .network-logo {
        filter: grayscale(0%); /* Full color on hover/selection */
    }

    .network-name {
        font-size: 1rem;
        font-weight: 600;
        color: var(--card-text);
        transition: color 0.2s ease;
    }

    .network-card:hover .network-name,
    .network-card.selected .network-name {
        color: white;
    }

    /* Styling for the content displayed below network selection */
    .network-shows-section h2 {
        font-size: 2rem;
        color: var(--highlight);
        margin-bottom: 20px;
    }

    /* Existing grid styling for show cards - reused */
    .shows-grid-container {
        display: grid;
        grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
        gap: 30px;
        justify-content: center;
        padding-bottom: 30px;
    }

    /* Enhanced Show Card for grid - copied from movies.html */
    .show-card-grid {
        background-color: var(--card-bg);
        border-radius: 12px;
        overflow: hidden;
        box-shadow: 0 6px 15px var(--card-shadow);
        transition: transform 0.2s ease, box-shadow 0.2s ease;
        display: flex;
        flex-direction: column;
        height: 100%;
        position: relative;
    }

    .show-card-grid:hover {
        transform: translateY(-8px);
        box-shadow: 0 8px 20px rgba(0, 0, 0, 0.2);
    }

    .show-card-grid a { /* Make entire card clickable */
        display: flex;
        flex-direction: column;
        height: 100%;
        text-decoration: none;
        color: inherit;
    }

    .show-card-grid-poster {
        width: 100%;
        height: 300px;
        object-fit: cover;
        display: block;
        border-bottom: 1px solid var(--card-border);
        transition: opacity 0.3s ease;
    }

    /* Fallback for missing images */
    .show-card-grid.no-image .show-card-grid-poster {
        display: none;
    }

    .show-card-grid.no-image .show-card-grid-content::before {
        content: 'No Image Available';
        display: flex;
        align-items: center;
        justify-content: center;
        height: 300px;
        background-color: var(--card-border);
        color: var(--text);
        font-size: 1.1rem;
        text-align: center;
        border-bottom: 1px solid var(--card-border);
        opacity: 0.7;
    }

    .show-card-grid-content {
        padding: 15px;
        display: flex;
        flex-direction: column;
        flex-grow: 1;
    }

    .show-card-grid-title {
        font-size: 1.2rem;
        font-weight: 700;
        color: var(--card-text);
        margin-bottom: 10px;
        line-height: 1.3;
    }

    .show-card-grid-meta {
        font-size: 0.95rem;
        color: var(--text);
        opacity: 0.8;
        margin-bottom: 8px;
    }

    .show-card-grid-meta span {
        display: block;
        margin-bottom: 4px;
    }

    .show-card-grid-meta span i {
        margin-right: 5px;
    }

    .show-card-grid-rating {
        position: absolute;
        top: 15px;
        left: 15px;
        background-color: var(--card-rating-bg);
        color: var(--card-rating-text);
        padding: 6px 10px;
        border-radius: 8px;
        font-size: 0.85rem;
        font-weight: 700;
        z-index: 10;
        box-shadow: 0 2px 5px rgba(0, 0, 0, 0.2);
    }

    .show-card-grid-network {
        display: flex;
        align-items: center;
        gap: 8px;
        margin-top: auto;
        padding-top: 10px;
        border-top: 1px solid var(--card-border);
        font-size: 0.85rem;
        color: var(--text);
        opacity: 0.9;
    }

    .show-card-grid-network img {
        width: 30px;
        height: auto;
        object-fit: contain;
        border-radius: 4px;
    }

    .show-card-grid-network a {
        color: var(--text);
        transition: color 0.2s ease;
    }
    .show-card-grid-network a:hover {
        color: var(--highlight);
    }

    /* Load More Button for Grid */
    .load-more-btn-grid-wrapper {
        text-align: center;
        margin-top: 30px;
        margin-bottom: 50px;
    }

    .load-more-btn-grid {
        background-color: var(--accent);
        color: white;
        padding: 12px 25px;
        border-radius: 8px;
        font-weight: 600;
        text-decoration: none;
        transition: background-color 0.2s ease, transform 0.2s ease;
        display: inline-block;
        box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1);
    }

    .load-more-btn-grid:hover {
        background-color: #218838;
        transform: translateY(-2px);
        box-shadow: 0 6px 15px rgba(0, 0, 0, 0.15);
    }


    /* Modal / Custom Alert Box */
    .custom-alert {
      display: none;
      position: fixed;
      z-index: 2000;
      left: 0;
      top: 0;
      width: 100%;
      height: 100%;
      overflow: auto;
      background-color: var(--modal-bg);
      align-items: center;
      justify-content: center;
      opacity: 0;
      visibility: hidden;
      transition: opacity 0.3s ease, visibility 0.3s ease;
    }

    .custom-alert.show {
      display: flex;
      opacity: 1;
      visibility: visible;
    }

    .alert-content {
      background-color: var(--modal-content-bg);
      margin: auto;
      padding: 30px;
      border-radius: 15px;
      box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
      text-align: center;
      max-width: 400px;
      width: 90%;
      position: relative;
      transform: translateY(-20px);
      transition: transform 0.3s ease;
    }

    .custom-alert.show .alert-content {
      transform: translateY(0);
    }

    .alert-icon {
      font-size: 3rem;
      margin-bottom: 20px;
    }

    .alert-icon.red-icon { color: var(--danger); }
    .alert-icon.blue-icon { color: var(--info); }
    .alert-icon.green-icon { color: var(--accent); }
    .alert-icon.yellow-icon { color: var(--warning); }


    #alertMessage {
      font-size: 1.1rem;
      color: var(--modal-text);
      margin-bottom: 20px;
    }

    #closeAlertBtn {
      background-color: var(--highlight);
      color: white;
      border: none;
      padding: 10px 20px;
      border-radius: 8px;
      cursor: pointer;
      font-size: 1rem;
      transition: background-color 0.2s ease;
    }

    #closeAlertBtn:hover {
      background-color: #0056b3;
    }


    /* Footer */
    .main-footer {
      background-color: var(--header-bg);
      color: var(--text);
      padding: 30px 20px;
      text-align: center;
      border-top: 1px solid var(--card-border);
      font-size: 0.9rem;
    }

    .footer-content {
      max-width: 1200px;
      margin: 0 auto;
      display: flex;
      flex-wrap: wrap;
      justify-content: space-between;
      gap: 20px;
    }

    .footer-section {
      flex: 1 1 200px;
      margin-bottom: 20px;
      text-align: left;
    }

    .footer-section h4 {
      font-size: 1.1rem;
      margin-bottom: 15px;
      color: var(--highlight);
    }

    .footer-section ul {
      list-style: none;
      padding: 0;
    }

    .footer-section ul li {
      margin-bottom: 8px;
    }

    .footer-section ul li a {
      color: var(--text);
      transition: color 0.2s ease;
    }

    .footer-section ul li a:hover {
      color: var(--highlight);
    }

    .footer-bottom {
      text-align: center;
      margin-top: 30px;
      padding-top: 20px;
      border-top: 1px solid var(--card-border);
    }

    .footer-bottom p {
      margin-bottom: 10px;
    }

    .social-icons {
      margin-top: 15px;
      display: flex;
      gap: 15px;
      justify-content: center;
    }

    .social-icons a {
      color: var(--text);
      font-size: 1.5rem;
      transition: color 0.2s ease;
    }

    .social-icons a:hover {
      color: var(--highlight);
    }


    /* Responsive Design adjustments */
    @media (min-width: 1025px) {
        .shows-grid-container {
            grid-template-columns: repeat(4, 1fr);
            gap: 30px;
        }
    }

    @media (max-width: 1024px) {
        .shows-grid-container {
            grid-template-columns: repeat(auto-fill, minmax(180px, 1fr));
            gap: 20px;
        }
        .show-card-grid-poster {
            height: 270px;
        }
    }

    @media (max-width: 768px) {
      /* Header Re-arrangement for small screens */
      .utility-header {
        flex-direction: column;
        text-align: center;
        padding-bottom: 10px;
      }
      .logo a {
        font-size: 1.5rem;
      }

      .header-utility-actions {
        width: 100%;
        justify-content: center;
        margin-top: 10px;
      }

      /* Hide desktop navigation on small screens */
      .main-nav-header {
        display: none;
      }

      /* Show mobile menu toggle icon on small screens */
      .mobile-menu-toggle {
        display: block;
      }
      /* Mobile nav links, hidden by default on mobile, toggled by JS */
      .mobile-nav-links {
          display: none;
          flex-direction: column;
          background-color: var(--header-bg);
          box-shadow: 0 2px 5px rgba(0,0,0,0.1);
          padding: 10px 20px;
          border-bottom: 1px solid var(--card-border);
      }
      /* Class added by JS to show the mobile menu */
      .mobile-nav-links.show-mobile-menu {
          display: flex;
      }
      .mobile-nav-links a {
        padding: 10px 0;
        text-align: center;
        border-bottom: 1px solid rgba(0,0,0,0.05);
        color: var(--text);
      }
      .mobile-nav-links a:last-child {
        border-bottom: none;
      }

      .footer-content {
        flex-direction: column;
        text-align: center;
      }

      .footer-section {
        flex: 1 1 100%;
        text-align: center;
      }

      .social-icons {
        justify-content: center;
      }

      .dynamic-search-area.show {
        max-height: 180px;
      }

      .search-input-wrapper {
        flex-wrap: wrap;
        justify-content: center;
      }

      .search-input-wrapper input[type="text"] {
        width: 100%;
        max-width: none;
      }

      .network-list-container {
        flex-direction: column;
        align-items: center;
      }
      .network-card {
        width: 80%; /* Make network cards wider on small screens */
        max-width: 250px;
      }
      .shows-grid-container {
          grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
          gap: 15px;
      }
      .show-card-grid-poster {
        height: 225px;
      }
    }

    /* Explicitly hide desktop navigation and mobile elements on large screens */
    @media (min-width: 769px) {
        .mobile-nav-links,
        .mobile-menu-toggle {
            display: none !important;
        }
        .main-nav-header {
            display: flex !important;
        }
    }
  </style>
</head>
<body>
  <!-- Custom Alert/Message Box Structure -->
  <div id="customAlert" class="custom-alert">
    <div class="alert-content">
      <i id="alertIcon" class="alert-icon fas fa-info-circle blue-icon"></i>
      <p id="alertMessage">This is a custom alert message.</p>
      <button id="closeAlertBtn">OK</button>
    </div>
  </div>

  <header class="main-global-header">
    <!-- Utility Header: Logo, Search Toggle, Account, Dark Mode, Mobile Menu Toggle -->
    <div class="utility-header">
      <div class="logo">
        <a href="index.html">CineWatch</a>
      </div>
      <div class="header-utility-actions">
        <!-- Search Icon (toggles expanded search bar) -->
        <div class="search-bar-toggle">
          <button class="search-toggle-button" id="searchToggleButton" aria-label="Toggle Search">
            <i class="fas fa-search"></i>
          </button>
        </div>

        <!-- Account Menu -->
        <div class="account-menu">
          <button class="account-button" id="accountButton" aria-label="Account Menu">
            <i class="fas fa-user-circle"></i>
          </button>
          <div class="account-dropdown" id="accountDropdown">
            <a href="profile.html" id="desktopProfileLink" class="account-item"><i class="fas fa-user"></i> Profile</a>
            <a href="settings.html" id="desktopSettingsLink" class="account-item"><i class="fas fa-cog"></i> Settings</a>
            <a href="watchlist.html" id="desktopWatchlistLink" class="account-item"><i class="fas fa-bookmark"></i> Watchlist</a>
            <a href="history.html" id="desktopHistoryLink" class="account-item"><i class="fas fa-history"></i> History</a>
            <a href="login.html" id="desktopLoginLink" class="account-item"><i class="fas fa-sign-in-alt"></i> Login</a>
            <a href="register.html" id="desktopRegisterLink" class="account-item"><i class="fas fa-user-plus"></i> Register</a>
            <a href="#" id="desktopLogoutLink" class="account-item"><i class="fas fa-sign-out-alt"></i> Logout</a>
          </div>
        </div>

        <!-- Dark Mode Toggle -->
        <button class="theme-toggle-button" id="darkModeToggle" aria-label="Toggle Dark Mode" title="Toggle Dark Mode">
          <i class="fas fa-moon"></i>
        </button>

        <!-- Mobile Menu Toggle -->
        <button class="mobile-menu-toggle" id="mobileMenuToggle" aria-label="Toggle Mobile Menu">
          <i class="fas fa-bars"></i>
        </button>
      </div>
    </div>

    <!-- Main Navigation Header (Desktop Only) -->
    <nav class="main-nav-header" id="mainNavHeader">
      <a href="movies.html?type=movie">Movies</a>
      <a href="tvshows.html">TV Shows</a>
      <a href="watchlist.html">Watchlist</a>
      <a href="tv_networks.html">TV Networks</a>
      <a href="cinema_guide.html">Cinema Guide</a>
      <a href="about_us.html">About Us</a>
    </nav>
  </header>

  <!-- Mobile Navigation Menu (Hidden by default, shown by JS toggle) -->
  <nav class="mobile-nav-links" id="mobileNavLinks">
    <a href="movies.html?type=movie">Movies</a>
    <a href="tvshows.html">TV Shows</a>
    <a href="watchlist.html">Watchlist</a>
    <a href="tv_networks.html">TV Networks</a>
    <a href="cinema_guide.html">Cinema Guide</a>
    <a href="about_us.html">About Us</a>
    <!-- Account links for mobile -->
    <a href="profile.html" id="mobileProfileLink">Profile</a>
    <a href="settings.html" id="mobileSettingsLink">Settings</a>
    <a href="watchlist.html" id="mobileWatchlistLink">Watchlist</a>
    <a href="history.html" id="mobileHistoryLink">History</a>
    <a href="login.html" id="mobileLoginLink">Login</a>
    <a href="register.html" id="mobileRegisterLink">Register</a>
    <a href="#" id="mobileLogoutLink">Logout</a>
  </nav>

  <!-- Dynamic Search Input Area (Animated reveal) -->
  <section class="dynamic-search-area" id="dynamicSearchArea">
    <div class="search-input-wrapper">
      <input type="text" id="expandedSearchBar" placeholder="Search movies, shows, cast..." aria-label="Expanded Search Bar">
      <button class="search-icon-btn" id="micIconBtn" aria-label="Voice Search"><i class="fas fa-microphone"></i></button>
      <button class="search-icon-btn clear-search-btn" id="clearSearchBtn" aria-label="Clear Search"><i class="fas fa-times"></i></button>
      <button class="search-button-label" id="searchActionBtn">Search</button>
    </div>
    <!-- Search Suggestions Container -->
    <div class="search-suggestions-container" id="searchSuggestionsContainer">
      <!-- Suggestions will be populated here -->
    </div>
    <div class="search-filters">
      <select id="genreFilter" aria-label="Filter by Genre">
        <option value="">All Genres</option>
        <!-- Genres will be dynamically populated here by JS -->
      </select>
      <select id="yearFilter" aria-label="Filter by Release Year">
        <option value="">All Years</option>
        <!-- Years will be dynamically populated here by JS -->
      </select>
      <input type="text" id="castFilter" placeholder="Filter by Cast" aria-label="Filter by Cast">
    </div>
  </section>

  <main>
    <section class="tv-networks-section">
      <h1 id="pageTitle">Browse TV Networks</h1>
      <div class="network-list-container" id="networkListContainer">
          <!-- Network cards will be populated here -->
      </div>

      <div class="network-shows-section" id="networkShowsSection" style="display:none;">
          <h2 id="networkShowsTitle"></h2>
          <div class="shows-grid-container" id="networkShowsGridContainer">
              <!-- TV Shows for the selected network will be populated here -->
          </div>
          <div class="load-more-btn-grid-wrapper">
              <button id="loadMoreBtn" class="load-more-btn-grid" style="display:none;">Load More</button>
          </div>
      </div>
    </section>
  </main>

  <footer class="main-footer">
    <div class="footer-content">
      <div class="footer-section">
        <h4>About CineWatch</h4>
        <ul>
          <li><a href="about_us.html">Our Story</a></li>
          <li><a href="contact.html">Contact Us</a></li>
          <li><a href="careers.html">Careers</a></li>
          <li><a href="investors.html">Investors</a></li>
          <li><a href="about_developer.html">About Developer</a></li>
        </ul>
      </div>
      <div class="footer-section">
        <h4>Help & Support</h4>
        <ul>
          <li><a href="support.html">FAQ</a></li>
          <li><a href="terms_of_service.html">Terms of Service</a></li>
          <li><a href="privacy_policy.html">Privacy Policy</a></li>
          <li><a href="sitemap.xml">Sitemap</a></li>
        </ul>
      </div>
      <div class="footer-section">
        <h4>Explore</h4>
        <ul>
          <li><a href="movies.html?type=movie">Movies</a></li>
          <li><a href="tvshows.html">TV Shows</a></li>
          <li><a href="watchlist.html">Watchlist</a></li>
          <li><a href="new_releases.html">New Releases</a></li>
        </ul>
      </div>
      <div class="footer-section">
        <h4>Connect with Us</h4>
        <p>Stay updated on our latest releases and news.</p>
        <div class="social-icons">
          <a href="https://www.facebook.com/aslekiymastamynd" target="_blank" rel="noopener noreferrer" aria-label="Facebook"><i class="fab fa-facebook-f"></i></a>
          <a href="https://x.com/yourhandle" target="_blank" rel="noopener noreferrer" aria-label="X (formerly Twitter)"><i class="fab fa-twitter"></i></a>
          <a href="https://www.instagram.com/yourprofile" target="_blank" rel="noopener noreferrer" aria-label="Instagram"><i class="fab fa-instagram"></i></a>
          <a href="https://www.linkedin.com/in/alexmalunda" target="_blank" rel="noopener noreferrer" aria-label="LinkedIn"><i class="fab fa-linkedin-in"></i></a>
        </div>
      </div>
    </div>
    <div class="footer-bottom">
      <p>&copy; <span id="current-year"></span> CineWatch. All rights reserved.</p>
      <p>Last Modified: <span id="last-modified"></span></p>
    </div>
  </footer>

  <script>
    // Global state for user login (simulated)
    let userLoggedIn = false;

    // --- Helper Functions (Moved to top for clarity and to fix ReferenceError) ---

    /**
     * Toggles dark mode on and off.
     */
    function toggleDarkMode() {
        const body = document.body;
        const darkModeToggle = document.getElementById('darkModeToggle');

        body.classList.toggle('dark-mode');
        const isDarkMode = body.classList.contains('dark-mode');

        if (darkModeToggle) {
            if (isDarkMode) {
                darkModeToggle.querySelector('i').classList.replace('fa-moon', 'fa-sun');
                darkModeToggle.setAttribute('aria-label', 'Toggle Light Mode');
                darkModeToggle.setAttribute('title', 'Toggle Light Mode');
            } else {
                darkModeToggle.querySelector('i').classList.replace('fa-sun', 'fa-moon');
                darkModeToggle.setAttribute('aria-label', 'Toggle Dark Mode');
                darkModeToggle.setAttribute('title', 'Toggle Dark Mode');
            }
        }
        localStorage.setItem('theme', isDarkMode ? 'dark' : 'light');
    }

    /**
     * Displays a custom alert/message box to the user.
     * @param {string} message - The message to display.
     * @param {string} iconClasses - Font Awesome classes for the icon.
     */
    function showMessageBox(message, iconClasses = "fas fa-info-circle blue-icon") {
        const customAlert = document.getElementById('customAlert');
        const alertMessage = document.getElementById('alertMessage');
        const alertIcon = customAlert.querySelector('.alert-icon');
        const closeAlertBtn = document.getElementById('closeAlertBtn');

        if (customAlert && alertMessage && alertIcon && closeAlertBtn) {
            alertMessage.textContent = message;
            alertIcon.className = 'alert-icon ' + iconClasses;
            customAlert.classList.add('show');

            const closeHandler = () => {
                customAlert.classList.remove('show');
                closeAlertBtn.removeEventListener('click', closeHandler);
            };
            closeAlertBtn.addEventListener('click', closeHandler);

            const overlayClickHandler = (event) => {
                if (event.target === customAlert) {
                    customAlert.classList.remove('show');
                    customAlert.removeEventListener('click', overlayClickHandler);
                }
            };
            customAlert.addEventListener('click', overlayClickHandler);
        } else {
            console.error("MessageBox elements not found. Cannot show message.");
        }
    }

    /**
     * Updates the visibility of login/logout/profile links in the account dropdown and mobile menu.
     * @param {boolean} isLoggedIn - True if the user is logged in, false otherwise.
     */
    function updateAccountDropdown(isLoggedIn) {
        // Desktop links
        const desktopLoginLink = document.getElementById('desktopLoginLink');
        const desktopRegisterLink = document.getElementById('desktopRegisterLink');
        const desktopProfileLink = document.getElementById('desktopProfileLink');
        const desktopSettingsLink = document.getElementById('desktopSettingsLink');
        const desktopWatchlistLink = document.getElementById('desktopWatchlistLink');
        const desktopHistoryLink = document.getElementById('desktopHistoryLink');
        const desktopLogoutLink = document.getElementById('desktopLogoutLink');

        // Mobile links
        const mobileProfileLink = document.getElementById('mobileProfileLink');
        const mobileSettingsLink = document.getElementById('mobileSettingsLink');
        const mobileWatchlistLink = document.getElementById('mobileWatchlistLink');
        const mobileHistoryLink = document.getElementById('mobileHistoryLink');
        const mobileLoginLink = document.getElementById('mobileLoginLink');
        const mobileRegisterLink = document.getElementById('mobileRegisterLink');
        const mobileLogoutLink = document.getElementById('mobileLogoutLink');

        const elementsToToggle = [
            { desktop: desktopLoginLink, mobile: mobileLoginLink, display: !isLoggedIn },
            { desktop: desktopRegisterLink, mobile: mobileRegisterLink, display: !isLoggedIn },
            { desktop: desktopProfileLink, mobile: mobileProfileLink, display: isLoggedIn },
            { desktop: desktopSettingsLink, mobile: mobileSettingsLink, display: isLoggedIn },
            { desktop: desktopWatchlistLink, mobile: mobileWatchlistLink, display: isLoggedIn },
            { desktop: desktopHistoryLink, mobile: mobileHistoryLink, display: isLoggedIn },
            { desktop: desktopLogoutLink, mobile: mobileLogoutLink, display: isLoggedIn }
        ];

        elementsToToggle.forEach(item => {
            if (item.desktop) item.desktop.style.display = item.display ? 'flex' : 'none';
            if (item.mobile) item.mobile.style.display = item.display ? 'flex' : 'none';
        });
        userLoggedIn = isLoggedIn; // Updates global state
    }


    // TMDB API Configuration
    const TMDB_API_KEY = '9c198aabc1df9fa96ea8d65e183cb8a3';
    const TMDB_BASE_URL = 'https://api.themoviedb.org/3';
    const TMDB_IMAGE_BASE_URL = 'https://image.tmdb.org/t/p/';
    const POSTER_SIZE = 'w342';
    const NETWORK_LOGO_SIZE = 'w92';

    // Transparent GIF for image fallback
    const IMAGE_NOT_FOUND_URL = 'data:image/gif;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs=';

    // Hardcoded list of popular TV Networks with their TMDB IDs
    // Note: TMDB Network IDs are for specific broadcast/streaming companies.
    // TMDB doesn't have a direct "list all networks" endpoint, so these are curated.
    // Updated logo_path to reference local files as requested.
    const TMDB_NETWORK_IDS = [
        { id: 213, name: 'Netflix', logo_path: 'images/logos_icons/netflixlogo.webp' },
        { id: 49, name: 'HBO', logo_path: 'images/logos_icons/hbologo.webp' },
        { id: 453, name: 'Hulu', logo_path: 'images/logos_icons/hululogo.webp' },
        { id: 1024, name: 'Amazon Prime Video', logo_path: 'images/logos_icons/amazonprimelogos.webp' },
        { id: 2739, name: 'Disney+', logo_path: 'images/logos_icons/disneypluslogo.webp' },
        { id: 2552, name: 'Apple TV+', logo_path: 'images/logos_icons/appletvpluslogo.webp' },
        { id: 6, name: 'NBC', logo_path: 'images/logos_icons/nbclogo.webp' },
        { id: 16, name: 'CBS', logo_path: 'images/logos_icons/cbslogo.webp' },
        { id: 19, name: 'Fox', logo_path: 'images/logos_icons/foxlogo.webp' },
        { id: 2, name: 'ABC', logo_path: 'images/logos_icons/abclogo.webp' }
    ];

    // State for network-specific content display
    let currentNetworkId = null;
    let currentNetworkPage = 1;
    let currentNetworkTotalPages = 1;

    /**
     * Fetches search results from TMDB's multi-search endpoint.
     * @param {string} query - The search query.
     * @returns {Promise<Array>} An array of search results (movies, TV shows, people).
     */
    async function fetchSearchResults(query) {
        if (!query) return [];
        try {
            const url = `${TMDB_BASE_URL}/search/multi?api_key=${TMDB_API_KEY}&language=en-US&query=${encodeURIComponent(query)}`;
            const response = await fetch(url);
            if (!response.ok) throw new Error(`HTTP error! status: ${response.status}`);
            const data = await response.json();
            // Filter out results without a title/name, and media_type not useful for direct display (e.g., 'collection')
            return data.results.filter(item =>
                (item.media_type === 'movie' || item.media_type === 'tv' || item.media_type === 'person') &&
                (item.title || item.name)
            );
        } catch (error) {
            console.error("Error fetching search results:", error);
            return [];
        }
    }

    /**
     * Displays search results as suggestions in the search suggestions container.
     * @param {Array} results - An array of search result objects (movies, TV shows, people).
     */
    function displaySearchResults(results) {
        const searchSuggestionsContainer = document.getElementById('searchSuggestionsContainer');
        if (!searchSuggestionsContainer) return;

        searchSuggestionsContainer.innerHTML = ''; // Clear previous suggestions

        if (results.length > 0) {
            results.slice(0, 5).forEach(item => { // Display top 5 suggestions
                const suggestionItem = document.createElement('div');
                suggestionItem.classList.add('search-suggestion-item');

                const imagePath = item.poster_path ? `${TMDB_IMAGE_BASE_URL}w92${item.poster_path}` :
                                  (item.profile_path ? `${TMDB_IMAGE_BASE_URL}w92${item.profile_path}` :
                                   'https://placehold.co/92x138/cccccc/555555?text=No+Image'); // Fallback for profile/poster

                const title = item.title || item.name;
                let subtitle = '';
                if (item.media_type === 'movie') {
                    subtitle = item.release_date ? `Movie (${new Date(item.release_date).getFullYear()})` : 'Movie';
                } else if (item.media_type === 'tv') {
                    subtitle = item.first_air_date ? `TV Show (${new Date(item.first_air_date).getFullYear()})` : 'TV Show';
                } else if (item.media_type === 'person') {
                    subtitle = item.known_for_department || 'Person';
                }

                suggestionItem.innerHTML = `
                    <img src="${imagePath}" alt="${title}" onerror="this.onerror=null; this.src='https://placehold.co/92x138/cccccc/555555?text=No+Image';">
                    <div class="search-suggestion-info">
                        <h4>${title}</h4>
                        <p>${subtitle}</p>
                    </div>
                `;
                searchSuggestionsContainer.appendChild(suggestionItem);

                // Add click listener to fill search bar and potentially navigate
                suggestionItem.addEventListener('click', () => {
                    document.getElementById('expandedSearchBar').value = title;
                    searchSuggestionsContainer.classList.remove('show');
                    // Optionally, navigate to details page immediately
                    if (item.media_type === 'movie' || item.media_type === 'tv') {
                        window.location.href = `details.html?id=${item.id}&type=${item.media_type}`;
                    } else if (item.media_type === 'person') {
                        showMessageBox(`Clicked on person: ${item.name}. (Navigation to person details not yet implemented)`, 'fas fa-info-circle blue-icon');
                    }
                });
            });
            searchSuggestionsContainer.classList.add('show'); // Show the container
        } else {
            searchSuggestionsContainer.classList.remove('show'); // Hide if no results
        }
    }

    /**
     * Debounce function to limit how often a function is called.
     * @param {Function} func - The function to debounce.
     * @param {number} delay - The delay in milliseconds.
     * @returns {Function} The debounced function.
     */
    function debounce(func, delay) {
        let timeout;
        return function(...args) {
            const context = this;
            clearTimeout(timeout);
            timeout = setTimeout(() => func.apply(context, args), delay);
        };
    }

    /**
     * Fetches a list of genres from TMDB API.
     * @param {string} type - 'movie' or 'tv'.
     * @returns {Promise<Array>} An array of genre objects.
     */
    async function fetchGenres(type) {
        const url = `${TMDB_BASE_URL}/genre/${type}/list?api_key=${TMDB_API_KEY}&language=en-US`;
        try {
            const response = await fetch(url);
            if (!response.ok) {
                console.warn(`Could not fetch ${type} genres. Status: ${response.status}.`);
                return [];
            }
            const data = await response.json();
            return data.genres;
        } catch (error) {
            console.warn(`Error fetching ${type} genres:`, error);
            return [];
        }
    }

    /**
     * Populates the year filter dropdown.
     * @param {HTMLSelectElement} selectElement - The select element to populate.
     * @param {number} startYear - The starting year.
     * @param {number} endYear - The ending year.
     */
    function populateYearFilter(selectElement, startYear, endYear) {
        selectElement.innerHTML = '<option value="">All Years</option>';
        for (let year = endYear; year >= startYear; year--) {
            const option = document.createElement('option');
            option.value = year;
            option.textContent = year;
            selectElement.appendChild(option);
        }
    }

    /**
     * Creates a card for a TV network.
     * @param {Object} network - The network object { id, name, logo_path }.
     * @returns {HTMLElement} The created network card div.
     */
    function createNetworkCard(network) {
        const card = document.createElement('div');
        card.classList.add('network-card');
        card.dataset.networkId = network.id;

        let logoUrl;
        // Check if the logo_path is a local path or a TMDB path
        if (network.logo_path && network.logo_path.startsWith('images/')) {
            logoUrl = network.logo_path; // Use local path directly
        } else if (network.logo_path) {
            logoUrl = `${TMDB_IMAGE_BASE_URL}${NETWORK_LOGO_SIZE}${network.logo_path}`; // Fallback to TMDB
        } else {
            logoUrl = 'https://placehold.co/92x92/cccccc/555555?text=No+Logo'; // Generic fallback
        }

        card.innerHTML = `
            <img src="${logoUrl}" alt="${network.name} Logo" class="network-logo" onerror="this.onerror=null; this.src='https://placehold.co/92x92/cccccc/555555?text=No+Logo';">
            <span class="network-name">${network.name}</span>
        `;

        card.addEventListener('click', () => {
            // Remove 'selected' class from previously selected card
            const currentSelected = document.querySelector('.network-card.selected');
            if (currentSelected) {
                currentSelected.classList.remove('selected');
            }
            // Add 'selected' class to the clicked card
            card.classList.add('selected');

            currentNetworkId = network.id;
            currentNetworkPage = 1; // Reset page when a new network is selected
            fetchAndDisplayShowsByNetwork(currentNetworkId, currentNetworkPage, true, network.name);
        });

        return card;
    }

    /**
     * Fetches and displays TV shows for a specific network.
     * @param {number} networkId - The TMDB network ID.
     * @param {number} page - The page number to fetch.
     * @param {boolean} clearGrid - If true, clears the current grid before adding new shows.
     * @param {string} networkName - The name of the network for title display.
     */
    async function fetchAndDisplayShowsByNetwork(networkId, page, clearGrid = true, networkName = '') {
        const networkShowsGridContainer = document.getElementById('networkShowsGridContainer');
        const networkShowsSection = document.getElementById('networkShowsSection');
        const networkShowsTitle = document.getElementById('networkShowsTitle');
        const loadMoreBtn = document.getElementById('loadMoreBtn');

        networkShowsSection.style.display = 'block'; // Show the section for network shows

        if (clearGrid) {
            networkShowsGridContainer.innerHTML = '';
            currentNetworkPage = 1;
            loadMoreBtn.style.display = 'none';
        }

        networkShowsTitle.textContent = `TV Shows from ${networkName}`;

        const params = new URLSearchParams();
        params.append('api_key', TMDB_API_KEY);
        params.append('language', 'en-US');
        params.append('page', page);
        params.append('sort_by', 'popularity.desc');
        params.append('with_networks', networkId);

        const fetchUrl = `${TMDB_BASE_URL}/discover/tv?${params.toString()}`;
        console.log('Fetching network content with URL:', fetchUrl); // Debugging log

        try {
            const response = await fetch(fetchUrl);
            console.log('Network API Response status:', response.status); // Debugging log
            if (!response.ok) {
                throw new Error(`Error fetching shows for network: ${response.statusText}`);
            }
            const data = await response.json();
            console.log('Network API Response data:', data); // Debugging log

            currentNetworkTotalPages = data.total_pages;

            if (data.results && data.results.length > 0) {
                const fragment = document.createDocumentFragment();
                for (const show of data.results) {
                    const card = createShowCardGrid(show, 'tv'); // Always 'tv' for network shows
                    fragment.appendChild(card);
                }
                networkShowsGridContainer.appendChild(fragment);
            } else if (clearGrid) {
                networkShowsGridContainer.innerHTML = '<p style="text-align: center; width: 100%; opacity: 0.7; color: var(--text);">No TV shows found for this network.</p>';
            }

            if (currentNetworkPage < currentNetworkTotalPages) {
                loadMoreBtn.style.display = 'inline-block';
            } else {
                loadMoreBtn.style.display = 'none';
            }

        } catch (error) {
            console.error(`Failed to load TV shows for network ${networkId}:`, error);
            networkShowsGridContainer.innerHTML = `<p style="text-align: center; width: 100%; opacity: 0.7; color: var(--danger);">Failed to load TV shows for this network: ${error.message}</p>`;
            loadMoreBtn.style.display = 'none';
        }
    }

    /**
     * Creates a show card for the grid layout using data directly from the discover API.
     * @param {Object} show - Basic show object from initial fetch (discover endpoint).
     * @param {string} mediaType - 'movie' or 'tv'.
     * @returns {HTMLElement} The created show card div.
     */
    function createShowCardGrid(show, mediaType) {
        const card = document.createElement('div');
        card.classList.add('show-card-grid');

        const posterPath = show.poster_path ? `${TMDB_IMAGE_BASE_URL}${POSTER_SIZE}${show.poster_path}` : IMAGE_NOT_FOUND_URL;
        const title = show.title || show.name;
        const voteAverage = show.vote_average ? show.vote_average.toFixed(1) : 'N/A';
        const originalLanguage = show.original_language ? show.original_language.toUpperCase() : 'N/A';

        let releaseInfo = '';
        let seasonsEpisodesInfo = '';
        let countryInfo = '';
        let networkHtml = '<span>Network: N/A</span>';

        if (mediaType === 'movie') {
            const releaseDate = show.release_date ? new Date(show.release_date).getFullYear() : 'N/A';
            releaseInfo = `<span><i class="fas fa-calendar-alt"></i> Release: ${releaseDate}</span>`;

            if (show.production_countries && show.production_countries.length > 0) {
                countryInfo = `<span><i class="fas fa-globe-americas"></i> Country: ${show.production_countries.map(c => c.iso_3166_1).join(', ')}</span>`;
            } else if (show.origin_country && show.origin_country.length > 0) {
                 countryInfo = `<span><i class="fas fa-globe-americas"></i> Country: ${show.origin_country.join(', ')}</span>`;
            }

            if (show.production_companies && show.production_companies.length > 0) {
                const company = show.production_companies[0];
                networkHtml = `
                    <a href="tv_networks.html?id=${company.id}&type=company">
                        <span>${company.name}</span>
                    </a>
                `;
            }

        } else { // mediaType === 'tv'
            const firstAirDate = show.first_air_date ? new Date(show.first_air_date).getFullYear() : 'N/A';
            releaseInfo = `<span><i class="fas fa-calendar-alt"></i> First Air: ${firstAirDate}</span>`;
            seasonsEpisodesInfo = show.number_of_seasons ? `<span><i class="fas fa-film"></i> Seasons: ${show.number_of_seasons || 'N/A'}</span>` : '';
            if (show.number_of_episodes) {
                seasonsEpisodesInfo += show.number_of_seasons ? `, Episodes: ${show.number_of_episodes}` : `<span><i class="fas fa-film"></i> Episodes: ${show.number_of_episodes}</span>`;
            }

            if (show.origin_country && show.origin_country.length > 0) {
                countryInfo = `<span><i class="fas fa-globe-americas"></i> Country: ${show.origin_country.join(', ')}</span>`;
            }

            if (show.networks && show.networks.length > 0) {
                const network = show.networks[0];
                // For the network logo within the show card, still rely on TMDB's path
                networkHtml = `
                    <a href="tv_networks.html?id=${network.id}&name=${encodeURIComponent(network.name)}">
                        <img src="${network.logo_path ? TMDB_IMAGE_BASE_URL + NETWORK_LOGO_SIZE + network.logo_path : 'https://placehold.co/30x30/cccccc/555555?text=N/A'}" alt="${network.name} Logo" onerror="this.onerror=null; this.src='https://placehold.co/30x30/cccccc/555555?text=N/A';">
                        <span>${network.name}</span>
                    </a>
                `;
            }
        }

        if (!show.poster_path) card.classList.add('no-image');

        card.innerHTML = `
            <a href="details.html?id=${show.id}&type=${mediaType}">
                <img src="${posterPath}" alt="${title} Poster" class="show-card-grid-poster" onerror="this.onerror=null; this.src='https://placehold.co/342x270/282828/f0f0f0?text=No+Image'; this.closest('.show-card-grid').classList.add('no-image');">
                <div class="show-card-grid-rating">${voteAverage}</div>
                <div class="show-card-grid-content">
                    <h3 class="show-card-grid-title">${title}</h3>
                    <p class="show-card-grid-meta">
                        <span><i class="fas fa-play-circle"></i> Type: ${mediaType === 'movie' ? 'Movie' : 'TV Show'}</span>
                        ${releaseInfo}
                        ${seasonsEpisodesInfo}
                        <span><i class="fas fa-language"></i> Lang: ${originalLanguage}</span>
                        ${countryInfo}
                        <span><i class="fas fa-info-circle"></i> More details on details page.</span>
                    </p>
                    <div class="show-card-grid-network">
                        ${networkHtml}
                    </div>
                </div>
            </a>
        `;
        return card;
    }


    // DOMContentLoaded event listener
    document.addEventListener('DOMContentLoaded', async () => {
        const accountButton = document.getElementById('accountButton');
        const accountDropdown = document.getElementById('accountDropdown');
        const mobileMenuToggle = document.getElementById('mobileMenuToggle');
        const mobileNavLinks = document.getElementById('mobileNavLinks');
        const darkModeToggle = document.getElementById('darkModeToggle');
        const desktopLogoutLink = document.getElementById('desktopLogoutLink');
        const mobileLogoutLink = document.getElementById('mobileLogoutLink');
        const searchToggleButton = document.getElementById('searchToggleButton');
        const dynamicSearchArea = document.getElementById('dynamicSearchArea');
        const expandedSearchBar = document.getElementById('expandedSearchBar');
        const micIconBtn = document.getElementById('micIconBtn');
        const clearSearchBtn = document.getElementById('clearSearchBtn');
        const searchActionBtn = document.getElementById('searchActionBtn');
        const genreFilter = document.getElementById('genreFilter'); // From search bar
        const yearFilter = document.getElementById('yearFilter'); // From search bar
        const searchSuggestionsContainer = document.getElementById('searchSuggestionsContainer');

        const networkListContainer = document.getElementById('networkListContainer');
        const networkShowsSection = document.getElementById('networkShowsSection');
        const networkShowsGridContainer = document.getElementById('networkShowsGridContainer');
        const networkShowsTitle = document.getElementById('networkShowsTitle');
        const loadMoreBtn = document.getElementById('loadMoreBtn');


        // --- Common Header/Footer/Search Bar Logic ---
        // Toggles Account Dropdown
        if (accountButton && accountDropdown) {
            accountButton.addEventListener('click', (e) => {
                e.stopPropagation();
                accountDropdown.classList.toggle('show');
            });
            document.addEventListener('click', (e) => {
                if (!accountDropdown.contains(e.target) && !accountButton.contains(e.target)) {
                    accountDropdown.classList.remove('show');
                }
                // Hide search suggestions if clicked outside
                if (searchSuggestionsContainer && !expandedSearchBar.contains(e.target) && !searchSuggestionsContainer.contains(e.target)) {
                    searchSuggestionsContainer.classList.remove('show');
                }
            });
        }

        // Toggles Mobile Menu
        if (mobileMenuToggle && mobileNavLinks) {
            mobileMenuToggle.addEventListener('click', () => {
                mobileNavLinks.classList.toggle('show-mobile-menu');
            });
        }

        // Toggles Dark Mode
        if (darkModeToggle) {
            darkModeToggle.addEventListener('click', toggleDarkMode);
        }

        // Handles Logout functionality (simulated)
        const performLogout = () => {
            showMessageBox('You have been logged out.', 'fas fa-check-circle green-icon');
            updateAccountDropdown(false);
            // Close mobile menu if open after logout
            if (mobileNavLinks) {
                mobileNavLinks.classList.remove('show-mobile-menu');
            }
        };

        if (desktopLogoutLink) {
            desktopLogoutLink.addEventListener('click', (e) => {
                e.preventDefault();
                performLogout();
            });
        }
        if (mobileLogoutLink) {
            mobileLogoutLink.addEventListener('click', (e) => {
                e.preventDefault();
                performLogout();
            });
        }

        // Initializes Dark Mode based on localStorage
        const storedTheme = localStorage.getItem('theme');
        if (storedTheme === 'dark') {
            document.body.classList.add('dark-mode');
            if (darkModeToggle) {
                darkModeToggle.querySelector('i').classList.replace('fa-moon', 'fa-sun');
                darkModeToggle.setAttribute('aria-label', 'Toggle Light Mode');
                darkModeToggle.setAttribute('title', 'Toggle Light Mode');
            }
        }
        updateAccountDropdown(false); // Initializes account dropdown based on userLoggedIn state (simulated as logged out)

        // Updates the current year in the footer
        const currentYearSpan = document.getElementById('current-year');
        if (currentYearSpan) {
            currentYearSpan.textContent = new Date().getFullYear();
        }

        // Sets Last Modified Date in footer
        const lastModifiedSpan_footer = document.getElementById('last-modified');
        if (lastModifiedSpan_footer) {
            lastModifiedSpan_footer.textContent = new Date(document.lastModified).toLocaleDateString();
        }

        // Handles Dynamic Search Bar Logic
        if (searchToggleButton && dynamicSearchArea && expandedSearchBar && searchActionBtn) {
            searchToggleButton.addEventListener('click', () => {
                const isShowing = dynamicSearchArea.classList.toggle('show');
                if (isShowing) {
                    expandedSearchBar.focus();
                } else {
                    // When hiding, also hide suggestions
                    if (searchSuggestionsContainer) searchSuggestionsContainer.classList.remove('show');
                }
            });

            // Debounced search input for suggestions
            const debouncedSearch = debounce(async (query) => {
                const results = await fetchSearchResults(query);
                displaySearchResults(results);
            }, 300); // 300ms debounce delay

            expandedSearchBar.addEventListener('input', () => {
                const query = expandedSearchBar.value.trim();
                if (query.length > 2) { // Start suggesting after 2 characters
                    debouncedSearch(query);
                } else {
                    if (searchSuggestionsContainer) searchSuggestionsContainer.classList.remove('show');
                }
                // Shows/hides searchActionBtn and manages clearSearchBtn based on input
                if (expandedSearchBar.value.length > 0) {
                    searchActionBtn.style.display = 'inline-block';
                    clearSearchBtn.style.display = 'inline-block';
                } else {
                    searchActionBtn.style.display = 'none';
                    clearSearchBtn.style.display = 'none';
                }
            });

            // Handles clear search button click
            clearSearchBtn.addEventListener('click', () => {
                expandedSearchBar.value = '';
                searchActionBtn.style.display = 'none';
                clearSearchBtn.style.display = 'none';
                if (searchSuggestionsContainer) searchSuggestionsContainer.classList.remove('show');
            });

            // Handles mic icon button click (placeholder)
            micIconBtn.addEventListener('click', () => {
                showMessageBox('Voice search activated. (Functionality not yet implemented)', 'fas fa-microphone blue-icon');
            });

            // index.html

/**
 * Fetches search results and redirects to the top result's detail page.
 */
const performSearch = async () => {
    const query = expandedSearchBar.value.trim();
    if (!query) {
        showMessageBox('Please enter a search term.', 'fas fa-info-circle yellow-icon');
        return;
    }

    // Hide suggestions dropdown
    if (searchSuggestionsContainer) {
        searchSuggestionsContainer.classList.remove('show');
    }

    try {
        // Fetch the search results
        const results = await fetchSearchResults(query);

        if (results && results.length > 0) {
            // Get the first valid result (movie, TV show, or person)
            const topResult = results[0];

            // Check if the top result has a valid media type for the details page
            if (topResult.media_type === 'movie' || topResult.media_type === 'tv' || topResult.media_type === 'person') {
                // Redirect to the details page with the correct ID and type
                window.location.href = `details.html?id=${topResult.id}&type=${topResult.media_type}`;
            } else {
                // Fallback for cases where the top result is not a supported type
                showMessageBox(`No direct match found for "${query}". Try selecting from the suggestions.`, 'fas fa-search blue-icon');
            }
        } else {
            showMessageBox(`No results found for "${query}". Please try a different search term.`, 'fas fa-exclamation-triangle red-icon');
        }
    } catch (error) {
        console.error('Search failed:', error);
        showMessageBox('An error occurred during the search. Please try again.', 'fas fa-server red-icon');
    }
};

// ... inside the DOMContentLoaded event listener ...

searchActionBtn.addEventListener('click', performSearch);
expandedSearchBar.addEventListener('keydown', (event) => {
    if (event.key === 'Enter') {
        performSearch();
    }
});

            // Populates genres for the search bar filter (all genres combined)
            const movieGenresForSearch = await fetchGenres('movie');
            const tvGenresForSearch = await fetchGenres('tv');
            const allGenresCombinedForSearch = [...new Map([...movieGenresForSearch, ...tvGenresForSearch].map(genre => [genre.id, genre])).values()];
            allGenresCombinedForSearch.sort((a, b) => a.name.localeCompare(b.name));
            // Assuming genreFilter is used for the main search area as well
            if (genreFilter) {
                genreFilter.innerHTML = `<option value="">All Genres</option>`;
                allGenresCombinedForSearch.forEach(item => {
                    const option = document.createElement('option');
                    option.value = item.id;
                    option.textContent = item.name;
                    genreFilter.appendChild(option);
                });
            }

            const currentYear = new Date().getFullYear();
            if (yearFilter) populateYearFilter(yearFilter, 1950, currentYear);
        }
        if (searchActionBtn) searchActionBtn.style.display = 'none';
        if (clearSearchBtn) clearSearchBtn.style.display = 'none';

        // --- TV Networks Page Specific Logic ---
        // Populate the network list
        if (networkListContainer) {
            TMDB_NETWORK_IDS.forEach(network => {
                const card = createNetworkCard(network);
                networkListContainer.appendChild(card);
            });
        }

        // Add event listener for Load More button
        if (loadMoreBtn) {
            loadMoreBtn.addEventListener('click', () => {
                currentNetworkPage++;
                fetchAndDisplayShowsByNetwork(currentNetworkId, currentNetworkPage, false, networkShowsTitle.textContent.replace('TV Shows from ', '')); // Append, keep network name
            });
        }

        // Check for pre-selected network from URL parameters (e.g., from a network link on details page)
        const urlParams = new URLSearchParams(window.location.search);
        const initialNetworkId = urlParams.get('id');
        const initialNetworkName = urlParams.get('name');

        if (initialNetworkId && initialNetworkName) {
            currentNetworkId = parseInt(initialNetworkId);
            const initialNetworkCard = document.querySelector(`.network-card[data-network-id="${currentNetworkId}"]`);
            if (initialNetworkCard) {
                initialNetworkCard.classList.add('selected');
            }
            fetchAndDisplayShowsByNetwork(currentNetworkId, 1, true, initialNetworkName);
        } else {
            // Optionally, select the first network by default or show a generic message
            // For now, it will simply display the list of networks and wait for user interaction
        }
    });
  </script>
</body>
</html>
