<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TV Network Info</title>
    <!-- Tailwind CSS CDN for easy styling -->
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* Custom styles for Inter font and some utility classes */
        body {
            font-family: "Inter", sans-serif;
            background-color: #f0f2f5;
        }
        /* Custom scrollbar for content area */
        .overflow-y-auto::-webkit-scrollbar {
            width: 8px;
        }
        .overflow-y-auto::-webkit-scrollbar-track {
            background: #e2e8f0; /* bg-gray-200 */
            border-radius: 10px;
        }
        .overflow-y-auto::-webkit-scrollbar-thumb {
            background: #cbd5e1; /* bg-gray-300 */
            border-radius: 10px;
        }
        .overflow-y-auto::-webkit-scrollbar-thumb:hover {
            background: #a0aec0; /* bg-gray-400 */
        }
    </style>
</head>
<body class="min-h-screen flex items-center justify-center py-10 px-4">
    <div class="bg-white p-8 rounded-xl shadow-lg w-full max-w-2xl border border-gray-200">
        <h1 class="text-3xl font-bold text-center text-gray-800 mb-6">TV Network Information</h1>

        <!-- Search Input -->
        <div class="flex flex-col sm:flex-row gap-4 mb-6">
            <input
                type="text"
                id="networkInput"
                placeholder="e.g., Netflix, HBO, Disney"
                class="flex-grow p-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 text-gray-700"
            />
            <button
                id="searchButton"
                class="bg-blue-600 text-white py-3 px-6 rounded-lg font-semibold hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 transition duration-200 ease-in-out shadow-md"
            >
                Search Network
            </button>
        </div>

        <!-- Loading Indicator -->
        <div id="loadingIndicator" class="text-center text-blue-600 font-medium hidden mb-4">
            Fetching information...
        </div>

        <!-- Error Message -->
        <div id="errorMessage" class="text-center text-red-600 font-medium hidden mb-4">
            Could not find information for this network. Please try again or a different name.
        </div>

        <!-- Network Info Display Area -->
        <div id="networkInfo" class="mt-6">
            <!-- Content will be dynamically inserted here -->
            <div class="bg-blue-50 p-6 rounded-lg text-center text-gray-600">
                Loading popular networks...
            </div>
        </div>
    </div>

    <script>
        // Get references to DOM elements
        const networkInput = document.getElementById('networkInput');
        const searchButton = document.getElementById('searchButton');
        const loadingIndicator = document.getElementById('loadingIndicator');
        const errorMessage = document.getElementById('errorMessage');
        const networkInfo = document.getElementById('networkInfo');

        // Wikipedia API endpoint for English Wikipedia
        const API_URL = "https://en.wikipedia.org/w/api.php";

        /**
         * Fetches information about a TV network from Wikipedia.
         * @param {string} networkName The name of the network to search for.
         */
        async function fetchNetworkInfo(networkName) {
            // Show loading indicator and hide previous messages/content
            loadingIndicator.classList.remove('hidden');
            errorMessage.classList.add('hidden');
            networkInfo.innerHTML = ''; // Clear previous content

            try {
                // Parameters for the Wikipedia API query
                // action=query: To get data
                // format=json: Desired format
                // prop=extracts|pageimages: Get article text and an image
                // exintro=true: Get only the introduction section
                // explaintext=true: Get plain text, not HTML
                // titles: The search term (network name)
                // pithumbsize=300: Max width for the image thumbnail
                // origin=*: Important for CORS when fetching from a browser
                const params = {
                    action: "query",
                    format: "json",
                    prop: "extracts|pageimages",
                    exintro: true,
                    explaintext: true,
                    titles: networkName,
                    pithumbsize: 300,
                    origin: "*" // Required for cross-origin requests
                };

                const response = await fetch(`${API_URL}?${new URLSearchParams(params)}`);
                const data = await response.json();

                // Hide loading indicator
                loadingIndicator.classList.add('hidden');

                // Check if any pages were returned and if there's an extract
                const pages = data.query.pages;
                const pageId = Object.keys(pages)[0]; // Get the first (and likely only) page ID

                if (pageId && pages[pageId].extract) {
                    const page = pages[pageId];
                    const title = page.title;
                    const summary = page.extract;
                    const imageUrl = page.thumbnail ? page.thumbnail.source : '';

                    displayNetworkInfoContent(title, summary, imageUrl);
                } else {
                    // No valid information found
                    errorMessage.classList.remove('hidden');
                    networkInfo.innerHTML = `
                        <div class="bg-red-50 p-6 rounded-lg text-center text-red-700">
                            No detailed information found for "${networkName}". Try a different name or spelling.
                        </div>
                    `;
                }

            } catch (error) {
                // Log and display fetch errors
                console.error("Error fetching network info:", error);
                loadingIndicator.classList.add('hidden');
                errorMessage.classList.remove('hidden');
                networkInfo.innerHTML = `
                    <div class="bg-red-50 p-6 rounded-lg text-center text-red-700">
                        An error occurred while fetching data. Please check your internet connection or try again later.
                    </div>
                `;
            }
        }

        /**
         * Fetches a list of popular TV networks from a Wikipedia category.
         */
        async function fetchPopularNetworks() {
            loadingIndicator.classList.remove('hidden');
            errorMessage.classList.add('hidden');
            networkInfo.innerHTML = `
                <div class="bg-blue-50 p-6 rounded-lg text-center text-gray-600">
                    Loading popular networks...
                </div>
            `;

            try {
                // Parameters to get members of the 'Television networks' category
                const params = {
                    action: "query",
                    format: "json",
                    list: "categorymembers",
                    cmtitle: "Category:Television networks", // Exact category name
                    cmlimit: 50, // Limit to 50 networks for initial load
                    cmtype: "page", // Only get pages, not subcategories or files
                    origin: "*"
                };

                const response = await fetch(`${API_URL}?${new URLSearchParams(params)}`);
                const data = await response.json();

                loadingIndicator.classList.add('hidden');

                if (data.query && data.query.categorymembers && data.query.categorymembers.length > 0) {
                    const networks = data.query.categorymembers.map(member => member.title);
                    displayNetworkList(networks);
                } else {
                    errorMessage.classList.remove('hidden');
                    networkInfo.innerHTML = `
                        <div class="bg-red-50 p-6 rounded-lg text-center text-red-700">
                            Could not load popular networks. Try searching manually.
                        </div>
                    `;
                }

            } catch (error) {
                console.error("Error fetching popular networks:", error);
                loadingIndicator.classList.add('hidden');
                errorMessage.classList.remove('hidden');
                networkInfo.innerHTML = `
                    <div class="bg-red-50 p-6 rounded-lg text-center text-red-700">
                        An error occurred while loading popular networks. Please try again later.
                    </div>
                `;
            }
        }

        /**
         * Displays a list of network names as clickable buttons.
         * @param {string[]} networks An array of network titles.
         */
        function displayNetworkList(networks) {
            networkInfo.innerHTML = `
                <div class="bg-blue-50 p-6 rounded-lg border border-blue-200">
                    <h2 class="text-xl font-bold text-gray-800 mb-4 text-center">Popular Networks</h2>
                    <div class="grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 gap-3 max-h-96 overflow-y-auto p-2">
                        ${networks.map(network => `
                            <button
                                class="network-item bg-blue-100 text-blue-800 py-2 px-3 rounded-md text-sm font-medium
                                    hover:bg-blue-200 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2
                                    transition duration-150 ease-in-out text-center truncate"
                                data-name="${network}"
                                title="${network}"
                            >
                                ${network}
                            </button>
                        `).join('')}
                    </div>
                </div>
            `;

            // Add event listeners to each dynamically created network button
            document.querySelectorAll('.network-item').forEach(button => {
                button.addEventListener('click', (event) => {
                    const networkName = event.target.dataset.name;
                    if (networkName) {
                        fetchNetworkInfo(networkName);
                    }
                });
            });
        }

        /**
         * Displays the fetched network information on the page.
         * Renamed from displayNetworkInfo to avoid confusion with the list display
         * @param {string} title The title of the network (e.g., "Netflix").
         * @param {string} summary The summary/history of the network.
         * @param {string} imageUrl An optional URL for the network's image.
         */
        function displayNetworkInfoContent(title, summary, imageUrl) {
            let imageHtml = '';
            if (imageUrl) {
                // Use a placeholder image as a fallback if the main image fails to load
                const placeholder = `https://placehold.co/300x200/e2e8f0/64748b?text=No+Image`;
                imageHtml = `
                    <div class="mb-6 flex justify-center">
                        <img
                            src="${imageUrl}"
                            alt="${title} Logo/Image"
                            class="rounded-lg shadow-md max-w-full h-auto"
                            onerror="this.onerror=null;this.src='${placeholder}';"
                        />
                    </div>
                `;
            }

            networkInfo.innerHTML = `
                <div class="bg-gray-50 p-6 rounded-lg border border-gray-200">
                    <h2 class="text-2xl font-bold text-gray-800 mb-4 text-center">${title}</h2>
                    ${imageHtml}
                    <p class="text-gray-700 leading-relaxed max-h-96 overflow-y-auto p-2">${summary}</p>
                    <p class="text-sm text-gray-500 mt-4 text-center">Information provided by Wikipedia.</p>
                    <button id="backToListButton"
                        class="mt-6 bg-gray-200 text-gray-800 py-2 px-4 rounded-lg font-semibold
                            hover:bg-gray-300 focus:outline-none focus:ring-2 focus:ring-gray-400 focus:ring-offset-2
                            transition duration-200 ease-in-out shadow-sm w-full"
                    >
                        Back to Popular Networks
                    </button>
                </div>
            `;
            // Add event listener for the back button
            document.getElementById('backToListButton').addEventListener('click', fetchPopularNetworks);
        }


        // Event Listeners for search bar
        searchButton.addEventListener('click', () => {
            const networkName = networkInput.value.trim();
            if (networkName) {
                fetchNetworkInfo(networkName);
            } else {
                errorMessage.textContent = "Please enter a network name to search.";
                errorMessage.classList.remove('hidden');
                networkInfo.innerHTML = `
                    <div class="bg-red-50 p-6 rounded-lg text-center text-red-700">
                        Please enter a network name to search.
                    </div>
                `;
            }
        });

        // Allow searching with Enter key
        networkInput.addEventListener('keypress', (event) => {
            if (event.key === 'Enter') {
                searchButton.click();
            }
        });

        // Load popular networks when the page loads
        document.addEventListener('DOMContentLoaded', fetchPopularNetworks);
    </script>
</body>
</html>
